# å‰ç«¯æ–‡æ¡£

AI-CRM å‰ç«¯ä»¥ç§»åŠ¨ä¼˜å…ˆä¸ºæ ¸å¿ƒè®¾è®¡ç†å¿µï¼Œè¦†ç›–ç™»å½•ã€ä»ªè¡¨ç›˜ã€å®¢æˆ·ã€å›è®¿ã€è®¢å•ã€é¢„è®¾æ•°æ®å’Œç³»ç»Ÿè®¾ç½®ç­‰å®Œæ•´ä¸šåŠ¡åœºæ™¯ï¼Œå¹¶åœ¨ç”Ÿäº§ç‰ˆæœ¬ä¸­æä¾› PWA æ”¯æŒã€‚

---

## ğŸš€ å¿«é€Ÿé¢„è§ˆ

### ç”Ÿäº§ç‰ˆï¼ˆpublic/ï¼‰
åŒ…å«å®Œæ•´ä¸šåŠ¡æµç¨‹ã€API è°ƒç”¨ã€PWA èƒ½åŠ›ï¼š
```bash
cd public
python3 -m http.server 8080
# æµè§ˆå™¨è®¿é—® http://localhost:8080
```

### é¢„è§ˆç‰ˆï¼ˆfrontend-preview/ï¼‰
çº¯é™æ€ç‰ˆæœ¬ï¼Œå†…ç½®æ¨¡æ‹Ÿæ•°æ®ä¾¿äºæ¼”ç¤ºï¼š
```bash
cd frontend-preview
./start-preview.sh
# æµè§ˆå™¨è®¿é—® http://localhost:8080
```

---

## ğŸ¨ è®¾è®¡ç­–ç•¥

### ç§»åŠ¨ä¼˜å…ˆ
- åº•éƒ¨å¯¼èˆª + é¡¶éƒ¨æ“ä½œåŒºï¼Œå•æ‰‹æ“ä½œå‹å¥½
- å¤§è§¦æ§åŒºåŸŸï¼ˆæœ€å° 44x44pxï¼‰ï¼Œé¿å…è¯¯è§¦
- çºµå‘ä¿¡æ¯æµï¼Œå‡å°‘æ¨ªå‘æ»šåŠ¨
- å­—ä½“ä½¿ç”¨æµå¼å•ä½ï¼Œä¿è¯å¯è¯»æ€§
- å……åˆ†åˆ©ç”¨å®‰å…¨åŒºï¼Œå…¼å®¹åˆ˜æµ·å±ã€æŒ–å­”å±

### å“åº”å¼å¸ƒå±€
| è§†å£å®½åº¦ | å¸ƒå±€ç­–ç•¥ |
| --- | --- |
| < 600px | å•åˆ—å¸ƒå±€ï¼Œåº•éƒ¨å¯¼èˆª |
| 600-1024px | åŒåˆ—ç½‘æ ¼ï¼Œå¯¼èˆªä¸å†…å®¹åˆ†ç¦» |
| â‰¥ 1024px | ä¾§è¾¹æ å¯¼èˆª + å¤šåˆ—å†…å®¹åŒº |

### ä¸»é¢˜ç³»ç»Ÿ
- å…¨å±€æµ…è‰² / æ·±è‰²ä¸»é¢˜åˆ‡æ¢
- ä¸»é¢˜åå¥½æŒä¹…åŒ–åˆ° `localStorage`
- CSS å˜é‡é©±åŠ¨é…è‰²ä¸é—´è·
- å¹³æ»‘è¿‡æ¸¡åŠ¨ç”»ï¼ˆ300msï¼‰ï¼Œé¿å…é—ªçƒ

---

## ğŸ—ºï¸ é¡µé¢ç»“æ„

| é¡µé¢ | ä¸»è¦åŠŸèƒ½ |
| --- | --- |
| `index.html` | ç™»å½•ã€èº«ä»½éªŒè¯ã€ä¸»é¢˜åˆ‡æ¢ |
| `dashboard.html` | å…³é”®æŒ‡æ ‡ã€æ„å‘åˆ†å¸ƒã€æé†’åˆ—è¡¨ |
| `customers.html` | æœç´¢ã€è¿‡æ»¤ã€å®¢æˆ·å¡ç‰‡å±•ç¤º |
| `customer-detail.html` | å®¢æˆ·ç”»åƒã€æ—¶é—´çº¿ã€è®¢å•åˆ—è¡¨ |
| `visits.html` | å›è®¿æ—¶é—´çº¿ã€æ»¡æ„åº¦ã€ä¸‹ä¸€æ­¥è®¡åˆ’ |
| `products.html` | é”€å”®ç»Ÿè®¡ã€è®¢å•ç®¡ç†ã€çŠ¶æ€ç­›é€‰ |
| `presets.html` | å®¢æˆ·åˆ†ç±»ã€æ„å‘ç­‰çº§ç­‰ 11 ç±»é¢„è®¾æ•°æ®ç®¡ç† |
| `settings.html` | è´¦æˆ·ä¿¡æ¯ã€é€šçŸ¥ã€å¯†ç ã€æ•°æ®ç»´æŠ¤ã€ä¸»é¢˜è®¾ç½® |

> é¢„è§ˆç‰ˆä¸ç”Ÿäº§ç‰ˆé¡µé¢ç»“æ„ä¸€è‡´ï¼Œä½†é¢„è§ˆç‰ˆä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œä»¥ä¾¿åœ¨æ— åç«¯ç¯å¢ƒä¸‹ä½“éªŒå®Œæ•´ UIã€‚

---

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

### é€šç”¨ä½“éªŒ
- Toast é€šçŸ¥ä¸è¡¨å•æ ¡éªŒå³æ—¶åé¦ˆ
- ç©ºçŠ¶æ€å¼•å¯¼å’Œé”™è¯¯æç¤º
- Loadingã€éª¨æ¶å±ã€åŠ¨ç”»è¿‡æ¸¡æå‡æ„ŸçŸ¥é€Ÿåº¦
- ARIA å±æ€§ä¸é”®ç›˜å¯¼èˆªï¼Œæ»¡è¶³ WCAG AA å¯¹æ¯”åº¦è¦æ±‚

### å„é¡µé¢äº®ç‚¹
- **ç™»å½•é¡µ**ï¼šç»ç’ƒæ‹Ÿæ€å¡ç‰‡ã€å¯†ç å¯è§åˆ‡æ¢ã€æ·±è‰²æ¨¡å¼å…¥å£
- **ä»ªè¡¨ç›˜**ï¼šå››å¤§æŒ‡æ ‡å¡ã€å®¢æˆ·æ„å‘åˆ†å¸ƒã€æé†’åˆ—è¡¨ã€å¿«æ·è·³è½¬
- **å®¢æˆ·åˆ—è¡¨**ï¼šå¤šç»´æœç´¢è¿‡æ»¤ã€ç»Ÿè®¡å¡ç‰‡ã€å¡ç‰‡å¼å®¢æˆ·ä¿¡æ¯
- **å®¢æˆ·è¯¦æƒ…**ï¼šæ¦‚è¦å¡ç‰‡ã€ä¿¡æ¯çŸ©é˜µã€Tab åˆ‡æ¢ã€æ—¶é—´çº¿ã€å¿«æ·æ“ä½œ
- **å›è®¿è®°å½•**ï¼šæ—¶é—´çº¿ã€æ»¡æ„åº¦æ ‡ç­¾ã€æ„å‘å˜åŒ–ç®­å¤´ã€ä¸‹ä¸€æ­¥è®¡åˆ’
- **äº§å“è®¢å•**ï¼šé”€å”®æŒ‡æ ‡ã€çŠ¶æ€æ ‡ç­¾ã€ç­›é€‰ã€å”®åä¿¡æ¯
- **é¢„è®¾æ•°æ®**ï¼šåˆ†ç±»åˆ‡æ¢ã€ç»Ÿè®¡ã€ç¼–è¾‘å…¥å£ã€ç©ºçŠ¶æ€æç¤º
- **è®¾ç½®é¡µé¢**ï¼šè´¦æˆ·ä¿¡æ¯ã€é€šçŸ¥å¼€å…³ã€å¯†ç ä¿®æ”¹ã€æ•°æ®ç»´æŠ¤æ“ä½œ

### é¢„ç•™èƒ½åŠ›
- å¯æ‰©å±• Chart.js / ECharts å›¾è¡¨
- æ”¯æŒé¢„è®¾æ•°æ®æ‹–æ‹½æ’åºã€å¼¹çª—è¡¨å•
- è®¾è®¡äº†æ‰¹é‡æ“ä½œã€å›½é™…åŒ–ã€PWA æ¨é€ç­‰æ‰©å±•æ¥å£

---

## ğŸ“Š æ¨¡æ‹Ÿæ•°æ®æ¦‚è§ˆï¼ˆé¢„è§ˆç‰ˆï¼‰

| æ¨¡å— | å…³é”®æ•°æ® |
| --- | --- |
| ä»ªè¡¨ç›˜ | æœˆé”€å”®é¢ Â¥285,680.50ã€è®¢å• 62ã€æ–°å¢å®¢æˆ· 15ã€å›è®¿ 28ã€æ´»è·ƒå®¢æˆ· 45 |
| å®¢æˆ· | 10 æ¡å…¨é‡ä¿¡æ¯ï¼Œè¦†ç›– VIPã€æ™®é€šã€æ½œåœ¨å®¢æˆ·ç­‰å¤šç±»æ ‡ç­¾ |
| å›è®¿ | 10 æ¡è®°å½•ï¼Œæ¶µç›–ç”µè¯ã€é¢è°ˆã€çº¿ä¸Šä¼šè®®ç­‰å¤šç§æ–¹å¼ï¼Œå«æ»¡æ„åº¦å’Œä¸‹ä¸€æ­¥è®¡åˆ’ |
| äº§å“è®¢å• | 10 æ¡è®¢å•ï¼Œæä¾›çŠ¶æ€ç­›é€‰ã€å…³è”å®¢æˆ·ã€å”®åä¿¡æ¯ |
| é¢„è®¾æ•°æ® | 11 ç±»é¢„è®¾ï¼ˆå®¢æˆ·åˆ†ç±»ã€æ„å‘ç­‰çº§ã€åœ°åŒºã€é¢„ç®—ã€å›è®¿æ–¹å¼/ç±»å‹ã€äº§å“ç­‰ï¼‰å…± 33 æ¡è®°å½• |
| è®¾ç½®é¡µé¢ | å±•ç¤ºé¢„è®¾ç»Ÿè®¡ã€æ•°æ®ç»´æŠ¤æ“ä½œï¼ˆå¤‡ä»½/æ¢å¤/æ¸…ç©ºï¼‰ |

æ‰€æœ‰æ•°æ®é€šè¿‡ `mockData` ç»Ÿä¸€ç®¡ç†ï¼Œå¹¶ç»“åˆ Alpine.js å“åº”å¼ç»‘å®šï¼Œå®ç°æœç´¢ã€è¿‡æ»¤ã€ç»Ÿè®¡ã€çŠ¶æ€æ ‡ç­¾ç­‰äº¤äº’ä½“éªŒã€‚

---

## ğŸ“¦ æ¶æ„ä¸æŠ€æœ¯

### ç›®å½•ç»“æ„ï¼ˆpublic/ï¼‰
```
public/
â”œâ”€â”€ components/          # HTML ç»„ä»¶ï¼ˆå¦‚å¯¼èˆªæ ï¼‰
â”œâ”€â”€ css/base.css         # æ ¸å¿ƒæ ·å¼ä¸ç»„ä»¶
â”œâ”€â”€ js/                  # ä¸šåŠ¡è„šæœ¬ä¸å·¥å…·
â”‚   â”œâ”€â”€ api-client.js    # API è¯·æ±‚ä¸ Token ç®¡ç†
â”‚   â”œâ”€â”€ auth-guard.js    # é¡µé¢è®¿é—®æ§åˆ¶
â”‚   â”œâ”€â”€ dashboard.js     # å„é¡µé¢é€»è¾‘ï¼ˆæŒ‰éœ€ï¼‰
â”‚   â”œâ”€â”€ navbar-loader.js # å¯¼èˆªåŠ è½½
â”‚   â””â”€â”€ pwa-register.js  # Service Worker æ³¨å†Œ
â”œâ”€â”€ manifest.json        # PWA é…ç½®
â”œâ”€â”€ service-worker.js    # PWA ç¼“å­˜é€»è¾‘
â””â”€â”€ *.html               # é¡µé¢å…¥å£
```

### Alpine.js ç¤ºä¾‹
```javascript
document.addEventListener('alpine:init', () => {
  Alpine.data('customersPage', () => ({
    search: '',
    filters: { category: 'all', intention: 'all' },
    customers: [],
    async init() {
      const { data } = await api.get('/api/customers');
      this.customers = data;
    }
  }));
});
```

### CSS å˜é‡
```css
:root {
  --primary: #2563EB;
  --success: #10B981;
  --warning: #F97316;
  --radius-lg: 18px;
  --spacing-6: 24px;
}

.card {
  background: var(--surface);
  border-radius: var(--radius-lg);
  padding: var(--spacing-6);
}
```

---

## ğŸ” è®¤è¯ä¸ API è°ƒç”¨ï¼ˆç”Ÿäº§ç‰ˆï¼‰

### Token ç®¡ç†
```javascript
// ç™»å½•è·å– Token
const { accessToken, refreshToken } = await api.post('/api/auth/login', {
  username,
  password,
});
localStorage.setItem('accessToken', accessToken);
localStorage.setItem('refreshToken', refreshToken);
```

- æ‰€æœ‰å—ä¿æŠ¤é¡µé¢é€šè¿‡ `auth-guard.js` æ ¡éªŒç™»å½•çŠ¶æ€
- è¯·æ±‚å¤±è´¥è¿”å› 401 æ—¶è‡ªåŠ¨å°è¯•åˆ·æ–° Token
- åˆ·æ–°å¤±è´¥ä¼šæ¸…ç†æœ¬åœ°çŠ¶æ€å¹¶è·³å›ç™»å½•é¡µ

### API å°è£…
```javascript
const api = {
  async get(path, params) {
    const query = new URLSearchParams(params).toString();
    const response = await fetch(`${path}?${query}`, {
      headers: { Authorization: `Bearer ${getAccessToken()}` },
    });
    return handleResponse(response);
  },
  // post / put / delete åŒç†
};
```

---

## ğŸ“± PWA èƒ½åŠ›ï¼ˆç”Ÿäº§ç‰ˆï¼‰

### å®‰è£…ä¸ä½“éªŒ
- **Android / Chrome**ï¼šè®¿é—®é¡µé¢æ—¶è‡ªåŠ¨å¼¹å‡º â€œå®‰è£…åˆ°ä¸»å±å¹•â€ æç¤º
- **iOS / Safari**ï¼šä½¿ç”¨â€œåˆ†äº«åˆ°ä¸»å±å¹•â€å®Œæˆå®‰è£…
- **æ¡Œé¢æµè§ˆå™¨**ï¼šåœ°å€æ æ˜¾ç¤ºå®‰è£…æŒ‰é’®ï¼Œå¯å®‰è£…åˆ°æ¡Œé¢å’Œå¼€å§‹èœå•

### ç¦»çº¿ç­–ç•¥
| èµ„æºç±»å‹ | ç­–ç•¥ | è¯´æ˜ |
| --- | --- | --- |
| HTMLã€CSSã€JS | Cache First | ä¼˜å…ˆä½¿ç”¨ç¼“å­˜ï¼Œåå°æ›´æ–° |
| API æ•°æ® | Network First | ç½‘ç»œä¼˜å…ˆï¼Œå¤±è´¥å›é€€ç¼“å­˜ï¼ˆ5 åˆ†é’Ÿï¼‰ |
| å›¾æ ‡èµ„æº | Cache Only | æ°¸ä¹…ç¼“å­˜ |

### è‡ªåŠ¨æ›´æ–°æµç¨‹
1. Service Worker æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬
2. åå°ä¸‹è½½æœ€æ–°èµ„æº
3. é¡µé¢æç¤ºâ€œå‘ç°æ–°ç‰ˆæœ¬â€
4. ç”¨æˆ·ç‚¹å‡»åç«‹å³åº”ç”¨æ–°ç‰ˆæœ¬

### å…³é”®æ–‡ä»¶
```
public/
â”œâ”€â”€ manifest.json        # åº”ç”¨åç§°ã€å›¾æ ‡ã€ä¸»é¢˜è‰²ç­‰
â”œâ”€â”€ service-worker.js    # ç¼“å­˜ç­–ç•¥ä¸ç‰ˆæœ¬ç®¡ç†
â”œâ”€â”€ js/pwa-register.js   # æ³¨å†Œä¸æ›´æ–°æç¤º
â””â”€â”€ icons/               # å¤šå°ºå¯¸å›¾æ ‡
```

### å¸¸è§é—®é¢˜
- **ç¦»çº¿çŠ¶æ€èƒ½åšä»€ä¹ˆï¼Ÿ** å¯æµè§ˆå·²ç¼“å­˜çš„é¡µé¢ä¸æ•°æ®ï¼›å¢åˆ æ”¹éœ€è”ç½‘
- **æ›´æ–°ä¸ç”Ÿæ•ˆï¼Ÿ** å…³é—­æ‰€æœ‰æ ‡ç­¾é¡µæˆ–æ¸…é™¤ç¼“å­˜åé‡è¯•
- **å¦‚ä½•å¸è½½ï¼Ÿ** ä¸åŸç”Ÿåº”ç”¨ä¸€è‡´ï¼Œåœ¨è®¾å¤‡ä¸Šç›´æ¥åˆ é™¤å³å¯

---

## ğŸ”„ æ•°æ®æµç¤ºæ„
```
ç”¨æˆ·äº¤äº’ â†’ Alpine.js çŠ¶æ€ â†’ API è¯·æ±‚ â†’ åç«¯æœåŠ¡
                                   â†“
ç•Œé¢æ›´æ–° â† å“åº”è§£æ â† é”™è¯¯å¤„ç† â† API è¿”å›ç»“æœ
```

### å…¸å‹æµç¨‹ï¼šåˆ›å»ºå®¢æˆ·
1. ç”¨æˆ·å¡«å†™è¡¨å•å¹¶æäº¤
2. è°ƒç”¨ `api.post('/api/customers', payload)`
3. è¯·æ±‚æˆåŠŸåæ˜¾ç¤º Toastï¼Œå¹¶åˆ·æ–°å®¢æˆ·åˆ—è¡¨
4. è‹¥å¤±è´¥ï¼Œå±•ç¤ºé”™è¯¯åŸå› å¹¶ä¿æŒè¡¨å•æ•°æ®

---

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ–°å¢é¡µé¢æ­¥éª¤
1. åˆ›å»º HTML æ–‡ä»¶å¹¶å¼•å…¥åŸºç¡€èµ„æºï¼š
```html
<link rel="stylesheet" href="/css/base.css">
<script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
<script src="/js/app.js" defer></script>
<script src="/js/api-client.js" defer></script>
<script src="/js/auth-guard.js" defer></script>
<script src="/js/navbar-loader.js" defer></script>
```
2. æ·»åŠ å¯¼èˆªå ä½å…ƒç´  `<div id="navbar-placeholder"></div>`
3. å®šä¹‰ Alpine ç»„ä»¶ç®¡ç†é¡µé¢çŠ¶æ€
4. éœ€è¦ API çš„é¡µé¢é…ç½®å¥½ `init`ã€é”™è¯¯å¤„ç†å’ŒåŠ è½½çŠ¶æ€

### æ ·å¼è§„èŒƒ
- å‘½åéµå¾ª BEM é£æ ¼ï¼š`component__element--state`
- é—´è·ç»Ÿä¸€ä½¿ç”¨ CSS å˜é‡ï¼š`var(--spacing-*)`
- åœ†è§’ã€é˜´å½±ã€é¢œè‰²ç»Ÿä¸€å®šä¹‰åœ¨ `:root`
- æ”¯æŒ `[data-theme="dark"]` é€‰æ‹©å™¨å®ç°æ·±è‰²æ¨¡å¼

### ç§»åŠ¨ç«¯ä¼˜åŒ–
- æ‰€æœ‰å¯ç‚¹å‡»å…ƒç´ æ·»åŠ  `:hover` ä¸ `:active` çŠ¶æ€
- è¾“å…¥æ¡†ä½¿ç”¨æ›´å¤§çš„è¡Œé«˜ä¸ padding
- è¡¨å•éªŒè¯æä¾›æ¸…æ™°çš„é”™è¯¯æç¤º

---

## ğŸŒ“ æ·±è‰²æ¨¡å¼

```javascript
function toggleTheme() {
  const html = document.documentElement;
  const next = html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
}

function restoreTheme() {
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
  }
}
```

```css
:root {
  --surface: #FFFFFF;
  --text-primary: #1F2937;
}

[data-theme="dark"] {
  --surface: #0F172A;
  --text-primary: #F1F5F9;
}
```

---

## ğŸ—“ï¸ ç‰ˆæœ¬æ›´æ–°

### v2.0.0ï¼ˆ2024-11-07ï¼‰
- å®Œæˆç§»åŠ¨ä¼˜å…ˆé‡æ„ï¼Œæ—§ç‰ˆæœ¬è¿ç§»è‡³ `old/` ç›®å½•
- é‡å†™å¯¼èˆªä½“ç³»ï¼šç§»åŠ¨ç«¯åº•éƒ¨å¯¼èˆªã€æ¡Œé¢ç«¯ä¾§è¾¹æ è‡ªåŠ¨åˆ‡æ¢
- å…¨é¢å‡çº§ UIï¼šå¡ç‰‡åŒ–å¸ƒå±€ã€æ·±è‰²æ¨¡å¼ã€è§¦æ§ä¼˜åŒ–
- é¡µé¢å¢å¼ºï¼šä»ªè¡¨ç›˜æŒ‡æ ‡ã€å®¢æˆ·è¯¦æƒ… Tabã€è®¢å•çŠ¶æ€æ ‡ç­¾ã€é¢„è®¾æ•°æ®åˆ†ç±»
- æŠ€æœ¯æ ˆæ•´ç†ï¼šCSS å˜é‡ + Alpine.jsï¼Œç§»é™¤å†—ä½™ä¾èµ–
- å¯è®¿é—®æ€§æ”¹è¿›ï¼šè¯­ä¹‰åŒ–æ ‡ç­¾ã€ç„¦ç‚¹ç®¡ç†ã€è‰²å½©å¯¹æ¯”è¾¾æ ‡

---

## ğŸ§­ åç»­è§„åˆ’
- æ¥å…¥çœŸå® API æ•°æ®
- ä¸°å¯Œæ•°æ®å¯è§†åŒ–ï¼ˆChart.js / EChartsï¼‰
- ä¸ºé¢„è®¾æ•°æ®ã€å®¢æˆ·ã€è®¢å•æä¾›æ–°å¢/ç¼–è¾‘å¼¹çª—
- æ”¯æŒæ‰¹é‡æ“ä½œã€æ•°æ®å¯¼å‡º
- å¼•å…¥å›½é™…åŒ–ä¸å¤šè¯­è¨€æ”¯æŒ
- å®ç°æ¨é€é€šçŸ¥ã€åå°åŒæ­¥ä¸ç¦»çº¿é˜Ÿåˆ—

---

**æœ€åæ›´æ–°**ï¼š2024-12-19  
**ç»´æŠ¤äºº**ï¼šAI Agent
